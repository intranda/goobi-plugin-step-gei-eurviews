
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:x="http://myfaces.apache.org/tomahawk">

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		<intranda:formInputDropDownAjax ajaxEvent="change" ajaxRender="@form"
			label="#{msgs.typeOfContribution}"
			field="#{AktuelleSchritteForm.myPlugin.contributionType}"
			help="#{msgs.help_GEI_ANNOTATION_CLASSIFICATION}"
			name="classification"
			selectItems="#{AktuelleSchritteForm.myPlugin.possibleClassifications}"
			required="false" var="classification"
			itemLabel="#{msgs[classification]}" itemValue="#{classification}"
			fieldStyle="form-control" />

		<div class="form-group">

			<div class="col-sm-3 control-label">
				<h:outputText value="#{msgs.Person}" />
			</div>
			<h:panelGroup layout="block" class="col-sm-9 inner-form"
				id="personList">

				<h:inputHidden id="rowIndex"
					value="#{AktuelleSchritteForm.myPlugin.index}" />
				<!--                                     <x:dataList var="author" value="#{AktuelleSchritteForm.myPlugin.authorList}" rowIndexVar="row.index"> -->
				<ui:repeat var="author"
					value="#{AktuelleSchritteForm.myPlugin.authorList}" varStatus="row">
					<div class="subform">

						<!--                                     <c:forEach var="author" items="#{AktuelleSchritteForm.myPlugin.authorList}" varStatus="row"> -->
						<intranda:formInputText label="#{msgs.firstname}"
							field="#{author.firstName}"
							help="#{msgs._GEI_DESCRIPTION_AUTHOR_FIRSTNAME}" name="author"
							fieldStyle="form-control" style="padding:4px;" required="false" />
						<intranda:formInputText label="#{msgs.lastname}"
							field="#{author.lastName}"
							help="#{msgs._GEI_DESCRIPTION_AUTHOR_LASTNAME}" name="lastname"
							fieldStyle="form-control" style="padding:4px;" required="false" />
						<intranda:formInputDropDown label="#{msgs.role}"
							field="#{author.role}"
							help="#{msgs.help_GEI_DESCRIPTION_AUTHOR_ROLE}" name="role"
							style="padding:4px;" var="docstruct"
							itemLabel="#{msgs[docstruct]}" itemValue="#{docstruct}"
							selectItems="#{AktuelleSchritteForm.myPlugin.possiblePersons}"
							required="false" fieldStyle="form-control" />

						<div class="form-group" style="padding: 4px;">
							<div class="col-sm-3 control-label">
								<h:outputText value="#{msgs.mets_authority_data}" />
							</div>

							<div class="col-sm-9">
								<div class="row" style="margin-left: 0px; margin-right: 0px;">
									<div class="col-sm-3">

										<h:selectOneMenu value="#{author.normdataAuthority}"
											styleClass="form-control">
											<f:ajax execute="@form" event="valueChange" />
											<f:selectItem itemLabel="gnd" itemValue="gnd" />
											<f:selectItem itemLabel="edu.experts" itemValue="edu.experts" />
										</h:selectOneMenu>

									</div>
									<div class="col-sm-9" style="background-color: #f6f6f6;">
										<div class="input-group" style="padding-left: 5px;">
											<h:inputText value="#{author.normdataValue}"
												styleClass="form-control">
												<f:ajax execute="@form" event="valueChange" />
											</h:inputText>
											<div class="input-group-addon"
												style="padding-top: 4px; padding-bottom: 4px;">
												<h:commandLink tabindex="-1" title="#{msgs.deletePerson}"
													action="#{AktuelleSchritteForm.myPlugin.deletePerson}"
													style="margin-right:5px;">
													<i class="fa fa-trash-o font-black" />
													<f:setPropertyActionListener value="#{author}"
														target="#{AktuelleSchritteForm.myPlugin.currentPerson}" />
													<f:ajax execute="@form" render="@form" />
												</h:commandLink>

												<a title="#{msgs.search}" href="#"
													id="rowIndexTrigger-#{row.index}" data-toggle="modal"
													data-row="#{row.index}" data-target="#searchBox"> <i
													class="fa fa-search font-black" />
												</a>
											</div>
										</div>
									</div>
								</div>


							</div>
						</div>
					</div>
				</ui:repeat>


				<script type="text/javascript">
					$('a[id*="rowIndexTrigger-"]').on('click', function() {
						var currIndex = $(this).attr('data-row');
						$('#rowIndex').val(currIndex);
					});
				</script>

				<h:panelGroup layout="block" id="duplicatebuttons">
					<!--  add -->
					<h:commandLink action="#{AktuelleSchritteForm.myPlugin.addAuthor}"
						title="#{msgs.addAuthor}">
						<i class="fa fa-plus margin-right-10" />
						<h:outputText value="#{msgs.addPerson}" />
						<f:ajax execute="@form" render="@form" />
					</h:commandLink>
				</h:panelGroup>
			</h:panelGroup>


		</div>


		<div style="display: #{NavigationForm.uiStatus.gei_showDetails!= 'down'?'none':'block'}">
			<intranda:formInputText label="#{msgs.edition}"
				field="#{AktuelleSchritteForm.myPlugin.edition}"
				help="#{msgs.help_GEI_ANNOTATION_EDITION}" name="edition"
				required="false" fieldStyle="form-control" />
			<intranda:formInputText label="#{msgs.publisher}"
				field="#{AktuelleSchritteForm.myPlugin.publisher}"
				help="#{msgs.help_GEI_ANNOTATION_PUBLISHER}" name="publisher"
				required="false" fieldStyle="form-control" />
			<intranda:formInputText label="#{msgs.project}"
				field="#{AktuelleSchritteForm.myPlugin.project}"
				help="#{msgs.help_GEI_ANNOTATION_PROJECT}" name="publisher"
				required="false" fieldStyle="form-control" />
			<intranda:formInputText label="#{msgs.availability}"
				field="#{AktuelleSchritteForm.myPlugin.availability}"
				help="#{msgs.help_GEI_ANNOTATION_AVAILIBILITY}" name="publisher"
				required="false" fieldStyle="form-control" />
			<intranda:formInputDropDown label="#{msgs.licence}"
				field="#{AktuelleSchritteForm.myPlugin.licence}"
				help="#{msgs.help_GEI_DESCRIPTION_LICENCE}" name="role"
				var="docstruct" itemLabel="#{msgs[docstruct]}"
				itemValue="#{docstruct}"
				selectItems="#{AktuelleSchritteForm.myPlugin.possibleLicences}"
				required="false" fieldStyle="form-control"
				style="border-bottom: 1px solid #DDDDDD;" />
		</div>

		<h:panelGroup styleClass="form-group" layout="block"
			rendered="#{AktuelleSchritteForm.myPlugin.contributionType != 'Bildungsgeschichte'}">

			<div class="col-sm-3 control-label">
				<h:outputText value="#{msgs.sources}" />
			</div>
			<div class="col-sm-9 inner-form">
				<x:dataList value="#{AktuelleSchritteForm.myPlugin.sourceList}"
					var="source">
					<div class="subform">

						<div class="form-group" style="padding: 4px;">
							<div class="col-sm-3 control-label">
								<h:outputLabel value="#{msgs.source}" for="itemTip" />
							</div>
							<div class="col-sm-9" style="background-color: #f6f6f6;">

								<div class="input-group">

									<p:autoComplete id="itemTip" value="#{source.data}"
										style="width:100%"
										completeMethod="#{AktuelleSchritteForm.myPlugin.completeSource}"
										var="data" itemLabel="#{data.resourceTitleOriginal}"
										itemValue="#{data}" converter="ResourceMetadataConverter"
										forceSelection="true">
										<p:column>
											<h:panelGrid columns="2" cellpadding="5" width="100%">
											<h:outputLabel for="resourceTitleOriginal"
												value="#{msgs.maintitle}:" />
											<h:outputText value="#{data.resourceTitleOriginal}"
												id="resourceTitleOriginal" />
											<h:outputLabel for="maintitleOriginal"
												value="#{msgs.maintitle}:" />
											<h:outputText
												value="#{data.bibliographicData.maintitleOriginal}"
												id="maintitleOriginal" />
											<h:outputLabel for="subtitle" value="#{msgs.subtitle}:" />
											<h:outputText
												value="#{data.bibliographicData.subtitleOriginal}"
												id="subtitle" />
                                            <h:outputLabel for="placeOfPublication" value="#{msgs.placeOfPublication}:" />
                                            <h:outputText value="#{data.bibliographicData.placeOfPublicationNames}" id="placeOfPublication" />
<!-- 											<br/> -->
											<h:outputLabel for="publicationYear"
												value="#{msgs.publicationYear}:" />
											<h:outputText
												value="#{data.bibliographicData.publicationYear}"
												id="publicationYear" />
											<h:outputLabel for="shelfmark" value="#{msgs.shelfmark}:" />
											<h:outputText value="#{data.bibliographicData.shelfmark}"
												id="shelfmark" />

                                            </h:panelGrid>
										</p:column>
									</p:autoComplete>
									<div class="input-group-addon"
										style="padding-top: 4px; padding-bottom: 4px;">
										<h:commandLink
											action="#{AktuelleSchritteForm.myPlugin.deleteSource}"
											style="float: right">
											<i class="fa fa-trash-o font-black" />
											<x:updateActionListener
												property="#{AktuelleSchritteForm.myPlugin.currentSource}"
												value="#{source}" />
										</h:commandLink>

									</div>
								</div>

							</div>
						</div>
						<intranda:formInputCheckBox label="#{msgs.mainsource}"
							field="#{source.mainSource}"
							help="#{msgs.help_GEI_ANNOTTATION_MAINSOURCE}" name="mainsource"
							style="padding:4px;" styleRight="background-color:#f6f6f6;" />

					</div>
				</x:dataList>


				<div id="duplicatebuttons">
					<h:commandLink action="#{AktuelleSchritteForm.myPlugin.addSource}"
						title="#{msgs.addSource}">
						<i class="fa fa-plus margin-right-10" />
						<h:outputText value="#{msgs.addSource}" />
						<f:ajax execute="@form" render="@form" />
					</h:commandLink>

				</div>
			</div>
		</h:panelGroup>
	</composite:implementation>
</ui:composition>